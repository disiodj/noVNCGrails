{"version":3,"sources":["browser.js"],"names":["isTouchDevice","document","documentElement","ontouchstart","undefined","navigator","maxTouchPoints","msMaxTouchPoints","window","addEventListener","onFirstTouch","removeEventListener","dragThreshold","devicePixelRatio","_supportsCursorURIs","target","createElement","style","cursor","indexOf","Log","Info","Warn","exc","Error","supportsCursorURIs","_hasScrollbarGutter","container","visibility","overflow","body","appendChild","child","scrollbarWidth","offsetWidth","parentNode","removeChild","hasScrollbarGutter","isMac","exec","platform","isWindows","isIOS","isSafari","userAgent","isFirefox"],"mappings":"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","sourcesContent":["/*\r\n * noVNC: HTML5 VNC client\r\n * Copyright (C) 2019 The noVNC Authors\r\n * Licensed under MPL 2.0 (see LICENSE.txt)\r\n *\r\n * See README.md for usage and integration instructions.\r\n *\r\n * Browser feature support detection\r\n */\r\n\r\nimport * as Log from './logging.js';\r\n\r\n// Touch detection\r\nexport let isTouchDevice = ('ontouchstart' in document.documentElement) ||\r\n                                 // requried for Chrome debugger\r\n                                 (document.ontouchstart !== undefined) ||\r\n                                 // required for MS Surface\r\n                                 (navigator.maxTouchPoints > 0) ||\r\n                                 (navigator.msMaxTouchPoints > 0);\r\nwindow.addEventListener('touchstart', function onFirstTouch() {\r\n    isTouchDevice = true;\r\n    window.removeEventListener('touchstart', onFirstTouch, false);\r\n}, false);\r\n\r\n\r\n// The goal is to find a certain physical width, the devicePixelRatio\r\n// brings us a bit closer but is not optimal.\r\nexport let dragThreshold = 10 * (window.devicePixelRatio || 1);\r\n\r\nlet _supportsCursorURIs = false;\r\n\r\ntry {\r\n    const target = document.createElement('canvas');\r\n    target.style.cursor = 'url(\"data:image/x-icon;base64,AAACAAEACAgAAAIAAgA4AQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAAAAAAAAAAAAAAAAAAAAA==\") 2 2, default';\r\n\r\n    if (target.style.cursor.indexOf(\"url\") === 0) {\r\n        Log.Info(\"Data URI scheme cursor supported\");\r\n        _supportsCursorURIs = true;\r\n    } else {\r\n        Log.Warn(\"Data URI scheme cursor not supported\");\r\n    }\r\n} catch (exc) {\r\n    Log.Error(\"Data URI scheme cursor test exception: \" + exc);\r\n}\r\n\r\nexport const supportsCursorURIs = _supportsCursorURIs;\r\n\r\nlet _hasScrollbarGutter = true;\r\ntry {\r\n    // Create invisible container\r\n    const container = document.createElement('div');\r\n    container.style.visibility = 'hidden';\r\n    container.style.overflow = 'scroll'; // forcing scrollbars\r\n    document.body.appendChild(container);\r\n\r\n    // Create a div and place it in the container\r\n    const child = document.createElement('div');\r\n    container.appendChild(child);\r\n\r\n    // Calculate the difference between the container's full width\r\n    // and the child's width - the difference is the scrollbars\r\n    const scrollbarWidth = (container.offsetWidth - child.offsetWidth);\r\n\r\n    // Clean up\r\n    container.parentNode.removeChild(container);\r\n\r\n    _hasScrollbarGutter = scrollbarWidth != 0;\r\n} catch (exc) {\r\n    Log.Error(\"Scrollbar test exception: \" + exc);\r\n}\r\nexport const hasScrollbarGutter = _hasScrollbarGutter;\r\n\r\n/*\r\n * The functions for detection of platforms and browsers below are exported\r\n * but the use of these should be minimized as much as possible.\r\n *\r\n * It's better to use feature detection than platform detection.\r\n */\r\n\r\nexport function isMac() {\r\n    return navigator && !!(/mac/i).exec(navigator.platform);\r\n}\r\n\r\nexport function isWindows() {\r\n    return navigator && !!(/win/i).exec(navigator.platform);\r\n}\r\n\r\nexport function isIOS() {\r\n    return navigator &&\r\n           (!!(/ipad/i).exec(navigator.platform) ||\r\n            !!(/iphone/i).exec(navigator.platform) ||\r\n            !!(/ipod/i).exec(navigator.platform));\r\n}\r\n\r\nexport function isSafari() {\r\n    return navigator && (navigator.userAgent.indexOf('Safari') !== -1 &&\r\n                         navigator.userAgent.indexOf('Chrome') === -1);\r\n}\r\n\r\nexport function isFirefox() {\r\n    return navigator && !!(/firefox/i).exec(navigator.userAgent);\r\n}\r\n\r\n"]}